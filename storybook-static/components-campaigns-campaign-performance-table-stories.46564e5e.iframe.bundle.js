/*! For license information please see components-campaigns-campaign-performance-table-stories.46564e5e.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[790],{"./.storybook/mocks/next-navigation.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){function useRouter(){return{push:_href=>{},replace:_href=>{},back:()=>{},forward:()=>{},refresh:()=>{},prefetch:async _href=>{}}}__webpack_require__.d(__webpack_exports__,{rd:()=>useRouter})},"./node_modules/lucide-react/dist/esm/createLucideIcon.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{A:()=>createLucideIcon});var react=__webpack_require__("./node_modules/react/index.js");const toPascalCase=string=>{const camelCase=(string=>string.replace(/^([A-Z])|[\s-_]+(\w)/g,(match,p1,p2)=>p2?p2.toUpperCase():p1.toLowerCase()))(string);return camelCase.charAt(0).toUpperCase()+camelCase.slice(1)},mergeClasses=(...classes)=>classes.filter((className,index,array)=>Boolean(className)&&""!==className.trim()&&array.indexOf(className)===index).join(" ").trim(),hasA11yProp=props=>{for(const prop in props)if(prop.startsWith("aria-")||"role"===prop||"title"===prop)return!0};var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Icon=(0,react.forwardRef)(({color="currentColor",size=24,strokeWidth=2,absoluteStrokeWidth,className="",children,iconNode,...rest},ref)=>(0,react.createElement)("svg",{ref,...defaultAttributes,width:size,height:size,stroke:color,strokeWidth:absoluteStrokeWidth?24*Number(strokeWidth)/Number(size):strokeWidth,className:mergeClasses("lucide",className),...!children&&!hasA11yProp(rest)&&{"aria-hidden":"true"},...rest},[...iconNode.map(([tag,attrs])=>(0,react.createElement)(tag,attrs)),...Array.isArray(children)?children:[children]])),createLucideIcon=(iconName,iconNode)=>{const Component=(0,react.forwardRef)(({className,...props},ref)=>{return(0,react.createElement)(Icon,{ref,iconNode,className:mergeClasses(`lucide-${string=toPascalCase(iconName),string.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${iconName}`,className),...props});var string});return Component.displayName=toPascalCase(iconName),Component}},"./node_modules/lucide-react/dist/esm/icons/chevron-down.js"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{A:()=>ChevronDown});const ChevronDown=(0,__webpack_require__("./node_modules/lucide-react/dist/esm/createLucideIcon.js").A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},"./src/components/campaigns/campaign-performance-table.stories.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>campaign_performance_table_stories});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function Link(props){const{href,children,...rest}=props;return(0,jsx_runtime.jsx)("a",{href,...rest,children})}Link.__docgenInfo={description:"",methods:[],displayName:"Link",props:{href:{required:!0,tsType:{name:"string"},description:""}}};var react=__webpack_require__("./node_modules/react/index.js"),ui_button=__webpack_require__("./src/components/ui/button.tsx"),input=__webpack_require__("./src/components/ui/input.tsx"),modal=__webpack_require__("./src/components/ui/modal.tsx"),campaign_performance=__webpack_require__("./src/lib/campaign-performance.ts"),utils=__webpack_require__("./src/lib/utils.ts"),chevron_down=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/chevron-down.js"),createLucideIcon=__webpack_require__("./node_modules/lucide-react/dist/esm/createLucideIcon.js");const Pause=(0,createLucideIcon.A)("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]]),Play=(0,createLucideIcon.A)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),Trash2=(0,createLucideIcon.A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),ChevronRight=(0,createLucideIcon.A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Ellipsis=(0,createLucideIcon.A)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),Copy=(0,createLucideIcon.A)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var next_navigation=__webpack_require__("./.storybook/mocks/next-navigation.ts");const COLUMNS=[{key:"name",label:"Campaign"},{key:"status",label:"Status"},{key:"progress",label:"Completion",numeric:!0},{key:"successRate",label:"Success Rate",numeric:!0},{key:"leads",label:"Leads",numeric:!0},{key:"completed",label:"Completed",numeric:!0},{key:"failed",label:"Failed",numeric:!0},{key:"createdAt",label:"Created",numeric:!0}],ALL_STATUSES=["Active","Paused","Completed","Draft","Failed"],EXPORT_PRESETS=["All Time","Last 7 Days","Last 30 Days","This Month","Custom"];const EXPORT_COLUMNS=[{key:"id",label:"ID"},{key:"name",label:"Campaign"},{key:"status",label:"Status"},{key:"total_leads",label:"Leads"},{key:"calls_completed",label:"Completed"},{key:"calls_failed",label:"Failed"},{key:"progress_pct",label:"Completion %"},{key:"success_rate_pct",label:"Success Rate %"},{key:"created_at",label:"Created At"}];function sortIndicator(spec,key){const s=(spec||[]).find(x=>x.key===key);return s?"asc"===s.dir?"↑":"↓":"↕"}function downloadBlob(blob,filename){const url=URL.createObjectURL(blob),a=document.createElement("a");a.href=url,a.download=filename,document.body.appendChild(a),a.click(),a.remove(),URL.revokeObjectURL(url)}function printCampaignsWithColumns(campaigns,columns,rangeLabel){const w=window.open("","_blank","noopener,noreferrer");if(!w)return;const headCells=columns.map(c=>`<th>${escapeHtml(c)}</th>`).join(""),rows=campaigns.map(c=>`<tr>${columns.map(col=>"id"===col?`<td>${escapeHtml(c.id)}</td>`:"name"===col?`<td>${escapeHtml(c.name)}</td>`:"status"===col?`<td>${escapeHtml((0,campaign_performance.mo)(c.status))}</td>`:"total_leads"===col?`<td style="text-align:right">${Number(c.total_leads||0).toLocaleString()}</td>`:"calls_completed"===col?`<td style="text-align:right">${Number(c.calls_completed||0).toLocaleString()}</td>`:"calls_failed"===col?`<td style="text-align:right">${Number(c.calls_failed||0).toLocaleString()}</td>`:"progress_pct"===col?`<td style="text-align:right">${(0,campaign_performance.Jb)(c).toFixed(1)}%</td>`:"success_rate_pct"===col?`<td style="text-align:right">${(0,campaign_performance.p$)(c).toFixed(1)}%</td>`:"created_at"===col?`<td>${escapeHtml(new Date(c.created_at).toLocaleString())}</td>`:"<td></td>").join("")}</tr>`).join("");w.document.write(`<!doctype html>\n<html>\n<head>\n  <meta charset="utf-8" />\n  <title>Campaign Export</title>\n  <style>\n    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;margin:20px;}\n    h1{font-size:16px;margin:0 0 12px;}\n    table{width:100%;border-collapse:collapse;}\n    th,td{border:1px solid #ddd;padding:8px;font-size:12px;}\n    th{text-align:left;background:#f5f5f5;}\n  </style>\n</head>\n<body>\n  <h1>Campaign Export (${escapeHtml(rangeLabel)})</h1>\n  <table>\n    <thead>\n      <tr>${headCells}</tr>\n    </thead>\n    <tbody>${rows}</tbody>\n  </table>\n</body>\n</html>`),w.document.close(),w.focus(),w.print()}function escapeHtml(value){return String(value??"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function csvEscape(value){const v=String(value??"");return v.includes(",")||v.includes('"')||v.includes("\n")||v.includes("\r")?`"${v.replaceAll('"','""')}"`:v}function toLocalStorage(key,value){try{window.localStorage.setItem(key,JSON.stringify(value))}catch{}}function fromLocalStorage(key,fallback){try{const raw=window.localStorage.getItem(key);return raw?JSON.parse(raw):fallback}catch{return fallback}}function CampaignPerformanceTable({campaigns,loading,error,onPause,onResume,onDelete,onDuplicate,onUpdate}){const router=(0,next_navigation.rd)(),[sort,setSort]=(0,react.useState)([]),[filters,setFilters]=(0,react.useState)({statuses:[],successMin:0,successMax:100,query:""}),[rowsPerPage,setRowsPerPage]=(0,react.useState)(25),[page,setPage]=(0,react.useState)(1),[statusOpen,setStatusOpen]=(0,react.useState)(!1),[suggestOpen,setSuggestOpen]=(0,react.useState)(!1),[menuOpenFor,setMenuOpenFor]=(0,react.useState)(null),[selected,setSelected]=(0,react.useState)(new Set),[expanded,setExpanded]=(0,react.useState)(new Set),[detailsId,setDetailsId]=(0,react.useState)(null),[editId,setEditId]=(0,react.useState)(null),[confirmDeleteId,setConfirmDeleteId]=(0,react.useState)(null),[exportOpen,setExportOpen]=(0,react.useState)(!1),[exportPreset,setExportPreset]=(0,react.useState)("All Time"),[exportFrom,setExportFrom]=(0,react.useState)(""),[exportTo,setExportTo]=(0,react.useState)(""),[exportCols,setExportCols]=(0,react.useState)(new Set(["name","status","total_leads","calls_completed","calls_failed","progress_pct","success_rate_pct","created_at"])),statusButtonRef=(0,react.useRef)(null),statusPanelRef=(0,react.useRef)(null),suggestRef=(0,react.useRef)(null),menuRefs=(0,react.useRef)({}),tableScrollRef=(0,react.useRef)(null);(0,react.useEffect)(()=>{const savedSort=fromLocalStorage("campaigns.performance.sort",[]),savedFilters=fromLocalStorage("campaigns.performance.filters",{statuses:[],successMin:0,successMax:100,query:""}),savedRows=fromLocalStorage("campaigns.performance.rowsPerPage",25),savedPage=fromLocalStorage("campaigns.performance.page",1),savedExport=fromLocalStorage("campaigns.performance.exportPrefs",null),raf=window.requestAnimationFrame(()=>{if(setSort(Array.isArray(savedSort)?savedSort:[]),setFilters(savedFilters),setRowsPerPage(savedRows),setPage(savedPage),savedExport&&(function isExportPreset(value){return"string"==typeof value&&EXPORT_PRESETS.includes(value)}(savedExport.preset)&&setExportPreset(savedExport.preset),"string"==typeof savedExport.from&&setExportFrom(savedExport.from),"string"==typeof savedExport.to&&setExportTo(savedExport.to),Array.isArray(savedExport.cols))){const allowed=new Set(EXPORT_COLUMNS.map(c=>c.key)),nextCols=savedExport.cols.filter(c=>allowed.has(c));setExportCols(new Set(nextCols))}});return()=>window.cancelAnimationFrame(raf)},[]),(0,react.useEffect)(()=>toLocalStorage("campaigns.performance.sort",sort),[sort]),(0,react.useEffect)(()=>toLocalStorage("campaigns.performance.filters",filters),[filters]),(0,react.useEffect)(()=>toLocalStorage("campaigns.performance.rowsPerPage",rowsPerPage),[rowsPerPage]),(0,react.useEffect)(()=>toLocalStorage("campaigns.performance.page",page),[page]),(0,react.useEffect)(()=>{toLocalStorage("campaigns.performance.exportPrefs",{preset:exportPreset,from:exportFrom,to:exportTo,cols:Array.from(exportCols)})},[exportCols,exportFrom,exportPreset,exportTo]),(0,react.useEffect)(()=>{const onMouseDown=e=>{const t=e.target;if(t){if(statusOpen){const btn=statusButtonRef.current,panel=statusPanelRef.current;if(btn&&btn.contains(t))return;if(panel&&panel.contains(t))return;setStatusOpen(!1)}if(suggestOpen){const box=suggestRef.current;if(box&&box.contains(t))return;setSuggestOpen(!1)}if(menuOpenFor){const menu=menuRefs.current[menuOpenFor];if(menu&&menu.contains(t))return;setMenuOpenFor(null)}}};return window.addEventListener("mousedown",onMouseDown),()=>window.removeEventListener("mousedown",onMouseDown)},[menuOpenFor,statusOpen,suggestOpen]),(0,react.useEffect)(()=>{const raf=window.requestAnimationFrame(()=>{setPage(1),setSelected(new Set),setExpanded(new Set),tableScrollRef.current&&(tableScrollRef.current.scrollTop=0)});return()=>window.cancelAnimationFrame(raf)},[filters,rowsPerPage,sort]);const nameSuggestions=(0,react.useMemo)(()=>{const q=(filters.query||"").trim().toLowerCase();if(q.length<2)return[];const names=campaigns.map(c=>c.name||"").filter(n=>n.toLowerCase().includes(q)).sort((a,b)=>a.localeCompare(b,void 0,{sensitivity:"base"}));return Array.from(new Set(names)).slice(0,6)},[campaigns,filters.query]),filtered=(0,react.useMemo)(()=>(0,campaign_performance.k3)(campaigns,filters),[campaigns,filters]),sorted=(0,react.useMemo)(()=>(0,campaign_performance.dG)(filtered,sort),[filtered,sort]),paged=(0,react.useMemo)(()=>(0,campaign_performance.En)(sorted,page,rowsPerPage),[page,rowsPerPage,sorted]),exportCandidates=(0,react.useMemo)(()=>0===selected.size?paged.slice:sorted.filter(c=>selected.has(c.id)),[paged.slice,selected,sorted]),exportRange=(0,react.useMemo)(()=>function computeExportRange(preset,fromISO,toISO){const now=new Date,startOfToday=new Date(now);if(startOfToday.setHours(0,0,0,0),"All Time"===preset)return{from:null,to:null,label:"All time"};if("Last 7 Days"===preset){const from=new Date(startOfToday);return from.setDate(from.getDate()-7),{from:from.getTime(),to:now.getTime(),label:"Last 7 days"}}if("Last 30 Days"===preset){const from=new Date(startOfToday);return from.setDate(from.getDate()-30),{from:from.getTime(),to:now.getTime(),label:"Last 30 days"}}if("This Month"===preset)return{from:new Date(now.getFullYear(),now.getMonth(),1).getTime(),to:now.getTime(),label:"This month"};const from=fromISO?new Date(`${fromISO}T00:00:00`).getTime():NaN,to=toISO?new Date(`${toISO}T23:59:59`).getTime():NaN,safeFrom=Number.isFinite(from)?from:null,safeTo=Number.isFinite(to)?to:null;return{from:safeFrom,to:safeTo,label:safeFrom&&safeTo?`${fromISO} → ${toISO}`:safeFrom?`Since ${fromISO}`:safeTo?`Until ${toISO}`:"Custom"}}(exportPreset,exportFrom,exportTo),[exportFrom,exportPreset,exportTo]),exportItems=(0,react.useMemo)(()=>function applyDateRangeByCreatedAt(items,range){if(!range.from&&!range.to)return items;const from=range.from??Number.NEGATIVE_INFINITY,to=range.to??Number.POSITIVE_INFINITY;return items.filter(c=>{const t=new Date(c.created_at).getTime();return!!Number.isFinite(t)&&t>=from&&t<=to})}(exportCandidates,exportRange),[exportCandidates,exportRange]),exportColumnList=(0,react.useMemo)(()=>{const cols=EXPORT_COLUMNS.map(c=>c.key).filter(k=>exportCols.has(k));return cols.length>0?cols:["name","status","created_at"]},[exportCols]),bulkCount=selected.size,allVisibleSelected=paged.slice.length>0&&paged.slice.every(c=>selected.has(c.id)),detailsCampaign=(0,react.useMemo)(()=>campaigns.find(c=>c.id===detailsId)||null,[campaigns,detailsId]),editCampaign=(0,react.useMemo)(()=>campaigns.find(c=>c.id===editId)||null,[campaigns,editId]),[editDraft,setEditDraft]=(0,react.useState)(null);(0,react.useEffect)(()=>{const raf=window.requestAnimationFrame(()=>{setEditDraft(editCampaign?{name:editCampaign.name||"",description:editCampaign.description||"",maxConcurrent:editCampaign.max_concurrent_calls||0,voiceId:editCampaign.voice_id||""}:null)});return()=>window.cancelAnimationFrame(raf)},[editCampaign]);const useVirtual="All"===rowsPerPage&&0===expanded.size&&paged.slice.length>50,[scrollTop,setScrollTop]=(0,react.useState)(0),[viewportH,setViewportH]=(0,react.useState)(520);(0,react.useEffect)(()=>{if(!useVirtual)return;const el=tableScrollRef.current;if(!el)return;const onScroll=()=>setScrollTop(el.scrollTop);onScroll(),el.addEventListener("scroll",onScroll,{passive:!0});const ro=new ResizeObserver(()=>setViewportH(el.clientHeight));return ro.observe(el),()=>{el.removeEventListener("scroll",onScroll),ro.disconnect()}},[useVirtual]);const virtual=(0,react.useMemo)(()=>{if(!useVirtual)return null;const total=paged.slice.length,startIndex=Math.max(0,Math.floor(scrollTop/56)-6),endIndex=Math.min(total,startIndex+Math.ceil(viewportH/56)+12);return{total,startIndex,endIndex,topPad:56*startIndex,bottomPad:56*(total-endIndex)}},[paged.slice.length,56,scrollTop,useVirtual,viewportH]),visibleRows=(0,react.useMemo)(()=>useVirtual&&virtual?paged.slice.slice(virtual.startIndex,virtual.endIndex):paged.slice,[paged.slice,useVirtual,virtual]),onExport=format=>{const items=exportItems;if("csv"===format){const csv=function campaignsToCsvWithColumns(campaigns,columns){const lines=[columns.join(",")];for(const c of campaigns){const row=columns.map(col=>"id"===col?csvEscape(c.id):"name"===col?csvEscape(c.name):"status"===col?csvEscape((0,campaign_performance.mo)(c.status)):"total_leads"===col?String(c.total_leads??0):"calls_completed"===col?String(c.calls_completed??0):"calls_failed"===col?String(c.calls_failed??0):"progress_pct"===col?(0,campaign_performance.Jb)(c).toFixed(1):"success_rate_pct"===col?(0,campaign_performance.p$)(c).toFixed(1):"created_at"===col?csvEscape(c.created_at):"");lines.push(row.join(","))}return lines.join("\n")}(items,exportColumnList);return void downloadBlob(new Blob([csv],{type:"text/csv;charset=utf-8"}),"campaigns-export.csv")}if("json"===format){const json=function campaignsToJsonWithColumns(campaigns,columns,meta){const items=campaigns.map(c=>{const out={};for(const col of columns)"id"===col?out[col]=c.id:"name"===col?out[col]=c.name:"status"===col?out[col]=(0,campaign_performance.mo)(c.status):"total_leads"===col?out[col]=Number(c.total_leads??0):"calls_completed"===col?out[col]=Number(c.calls_completed??0):"calls_failed"===col?out[col]=Number(c.calls_failed??0):"progress_pct"===col?out[col]=Number((0,campaign_performance.Jb)(c).toFixed(1)):"success_rate_pct"===col?out[col]=Number((0,campaign_performance.p$)(c).toFixed(1)):"created_at"===col&&(out[col]=c.created_at);return out});return JSON.stringify({generatedAt:(new Date).toISOString(),range:meta.rangeLabel,items},null,2)}(items,exportColumnList,{rangeLabel:exportRange.label});return void downloadBlob(new Blob([json],{type:"application/json"}),"campaigns-export.json")}printCampaignsWithColumns(items,exportColumnList,exportRange.label)},TableHeader=(0,jsx_runtime.jsxs)("div",{role:"row",className:"grid grid-cols-[40px_1.4fr_120px_160px_140px_110px_110px_110px_170px_44px] gap-2 border-b border-white/10 px-3 py-2 text-xs font-semibold text-gray-300",children:[(0,jsx_runtime.jsx)("div",{className:"flex items-center justify-center",children:(0,jsx_runtime.jsx)("input",{"aria-label":"Select all visible campaigns",type:"checkbox",checked:allVisibleSelected,onChange:e=>{return next=e.target.checked,void setSelected(prev=>{const copy=new Set(prev);for(const c of paged.slice)next?copy.add(c.id):copy.delete(c.id);return copy});var next},className:"h-4 w-4 rounded border-white/20 bg-white/5"})}),COLUMNS.map(c=>(0,jsx_runtime.jsxs)("button",{type:"button",onClick:e=>((key,e)=>{const multi=e.shiftKey;setSort(prev=>function toggleSort(prev,key,multi){const idx=prev.findIndex(s=>s.key===key),next=multi?[...prev]:[];if(-1===idx)return next.push({key,dir:"asc"}),next;const current=prev[idx],dir="asc"===current.dir?"desc":"asc";return multi?(next[idx]={...current,dir},next):[{key,dir}]}(prev,key,multi))})(c.key,e),className:(0,utils.cn)("flex items-center gap-2 rounded-md px-2 py-1 text-left hover:bg-white/5 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white/30",c.numeric?"justify-end":"justify-start"),"aria-label":`Sort by ${c.label}`,children:[(0,jsx_runtime.jsx)("span",{className:"truncate",children:c.label}),(0,jsx_runtime.jsx)("span",{className:"text-gray-400",children:sortIndicator(sort,c.key)})]},c.key)),(0,jsx_runtime.jsx)("div",{})]});return(0,jsx_runtime.jsxs)("div",{className:"space-y-4",children:[(0,jsx_runtime.jsx)("div",{className:"content-card",children:(0,jsx_runtime.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-end md:justify-between",children:[(0,jsx_runtime.jsxs)("div",{className:"flex-1",children:[(0,jsx_runtime.jsx)("div",{className:"text-sm font-semibold text-white",children:"Filters"}),(0,jsx_runtime.jsxs)("div",{className:"mt-2 grid grid-cols-1 gap-3 md:grid-cols-3",children:[(0,jsx_runtime.jsxs)("div",{className:"relative",ref:suggestRef,children:[(0,jsx_runtime.jsx)("label",{className:"text-xs font-semibold text-gray-300",children:"Campaign name"}),(0,jsx_runtime.jsx)(input.p,{value:filters.query,placeholder:"Search campaigns…",onChange:e=>{const next=e.target.value;setFilters(p=>({...p,query:next})),setSuggestOpen(!0)},onFocus:()=>{nameSuggestions.length>0&&setSuggestOpen(!0)},className:"mt-1 border-white/10 bg-white/5 text-white placeholder:text-gray-400 focus-visible:ring-white/30"}),suggestOpen&&nameSuggestions.length>0?(0,jsx_runtime.jsx)("div",{role:"listbox",className:"absolute z-20 mt-2 w-full overflow-hidden rounded-xl border border-white/10 bg-gray-950/95 shadow-xl",children:nameSuggestions.map(n=>(0,jsx_runtime.jsx)("button",{type:"button",role:"option",className:"flex w-full items-center justify-between px-3 py-2 text-left text-sm text-white hover:bg-white/5",onClick:()=>{setFilters(p=>({...p,query:n})),setSuggestOpen(!1)},children:(0,jsx_runtime.jsx)("span",{className:"truncate",children:n})},n))}):null]}),(0,jsx_runtime.jsxs)("div",{className:"relative",children:[(0,jsx_runtime.jsx)("label",{className:"text-xs font-semibold text-gray-300",children:"Status"}),(0,jsx_runtime.jsxs)("button",{ref:statusButtonRef,type:"button",onClick:()=>setStatusOpen(v=>!v),className:"mt-1 flex h-10 w-full items-center justify-between rounded-md border border-white/10 bg-white/5 px-3 text-sm text-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white/30","aria-haspopup":"listbox","aria-expanded":statusOpen,children:[(0,jsx_runtime.jsx)("span",{className:"truncate",children:0===filters.statuses.length?"All statuses":`${filters.statuses.length} selected`}),(0,jsx_runtime.jsx)(chevron_down.A,{className:"h-4 w-4 text-gray-300"})]}),statusOpen?(0,jsx_runtime.jsxs)("div",{ref:statusPanelRef,className:"absolute z-20 mt-2 w-full overflow-hidden rounded-xl border border-white/10 bg-gray-950/95 p-2 shadow-xl",children:[ALL_STATUSES.map(s=>{const checked=filters.statuses.includes(s);return(0,jsx_runtime.jsxs)("label",{className:"flex cursor-pointer items-center justify-between rounded-lg px-2 py-2 text-sm text-white hover:bg-white/5",children:[(0,jsx_runtime.jsx)("span",{className:"flex items-center gap-2",children:(0,jsx_runtime.jsx)("span",{className:(0,utils.cn)("inline-flex items-center rounded-full px-2 py-0.5 text-xs font-semibold",(0,campaign_performance.AO)(s)),children:s})}),(0,jsx_runtime.jsx)("input",{type:"checkbox",checked,onChange:e=>{const next=e.target.checked;setFilters(p=>{const set=new Set(p.statuses);return next?set.add(s):set.delete(s),{...p,statuses:Array.from(set)}})},className:"h-4 w-4 rounded border-white/20 bg-white/5"})]},s)}),(0,jsx_runtime.jsxs)("div",{className:"mt-2 flex items-center justify-between gap-2",children:[(0,jsx_runtime.jsx)(ui_button.$,{type:"button",variant:"secondary",size:"sm",onClick:()=>setFilters(p=>({...p,statuses:[]})),children:"Clear"}),(0,jsx_runtime.jsx)(ui_button.$,{type:"button",variant:"outline",size:"sm",onClick:()=>setStatusOpen(!1),children:"Done"})]})]}):null]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"text-xs font-semibold text-gray-300",children:"Success rate"}),(0,jsx_runtime.jsxs)("div",{className:"mt-1 rounded-md border border-white/10 bg-white/5 p-3",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)("input",{"aria-label":"Minimum success rate",type:"number",min:0,max:100,value:filters.successMin,onChange:e=>{const v=Number(e.target.value);setFilters(p=>({...p,successMin:Number.isFinite(v)?Math.max(0,Math.min(100,v)):0}))},className:"h-9 w-20 rounded-md border border-white/10 bg-white/5 px-2 text-sm text-white"}),(0,jsx_runtime.jsx)("span",{className:"text-sm text-gray-400",children:"to"}),(0,jsx_runtime.jsx)("input",{"aria-label":"Maximum success rate",type:"number",min:0,max:100,value:filters.successMax,onChange:e=>{const v=Number(e.target.value);setFilters(p=>({...p,successMax:Number.isFinite(v)?Math.max(0,Math.min(100,v)):100}))},className:"h-9 w-20 rounded-md border border-white/10 bg-white/5 px-2 text-sm text-white"}),(0,jsx_runtime.jsxs)("div",{className:"flex-1 text-right text-xs font-semibold text-gray-300",children:[Math.min(filters.successMin,filters.successMax),"–",Math.max(filters.successMin,filters.successMax),"%"]})]}),(0,jsx_runtime.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-3",children:[(0,jsx_runtime.jsx)("input",{"aria-label":"Minimum success rate slider",type:"range",min:0,max:100,value:filters.successMin,onChange:e=>setFilters(p=>({...p,successMin:Number(e.target.value)}))}),(0,jsx_runtime.jsx)("input",{"aria-label":"Maximum success rate slider",type:"range",min:0,max:100,value:filters.successMax,onChange:e=>setFilters(p=>({...p,successMax:Number(e.target.value)}))})]})]})]})]})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)(ui_button.$,{type:"button",variant:"outline",onClick:()=>setExportOpen(!0),children:"Export"}),(0,jsx_runtime.jsx)(Link,{href:"/campaigns/new",children:(0,jsx_runtime.jsx)(ui_button.$,{type:"button",children:"New Campaign"})})]})]})}),bulkCount>0?(0,jsx_runtime.jsxs)("div",{className:"content-card flex flex-wrap items-center justify-between gap-3",children:[(0,jsx_runtime.jsxs)("div",{className:"text-sm font-semibold text-white",children:[bulkCount," selected"]}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,jsx_runtime.jsxs)(ui_button.$,{type:"button",variant:"outline",size:"sm",onClick:async()=>{const ids=Array.from(selected);for(const id of ids)await onPause(id);setSelected(new Set)},children:[(0,jsx_runtime.jsx)(Pause,{className:"h-4 w-4"}),"Pause Selected"]}),(0,jsx_runtime.jsxs)(ui_button.$,{type:"button",variant:"outline",size:"sm",onClick:async()=>{const ids=Array.from(selected);for(const id of ids)await onResume(id);setSelected(new Set)},children:[(0,jsx_runtime.jsx)(Play,{className:"h-4 w-4"}),"Resume Selected"]}),(0,jsx_runtime.jsx)(ui_button.$,{type:"button",variant:"secondary",size:"sm",onClick:()=>setExportOpen(!0),children:"Export Selected"}),(0,jsx_runtime.jsxs)(ui_button.$,{type:"button",variant:"destructive",size:"sm",onClick:()=>setConfirmDeleteId("__bulk__"),children:[(0,jsx_runtime.jsx)(Trash2,{className:"h-4 w-4"}),"Delete Selected"]})]})]}):null,(0,jsx_runtime.jsxs)("div",{className:"content-card overflow-hidden",children:[(0,jsx_runtime.jsxs)("div",{className:"flex flex-col gap-3 border-b border-white/10 px-4 py-3 md:flex-row md:items-center md:justify-between",children:[(0,jsx_runtime.jsxs)("div",{className:"text-sm text-gray-300",children:[paged.start,"-",paged.end," of ",sorted.length]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jsx_runtime.jsx)("div",{className:"text-xs font-semibold text-gray-300",children:"Rows"}),(0,jsx_runtime.jsxs)("select",{"aria-label":"Rows per page",value:rowsPerPage,onChange:e=>{const v=e.target.value,next="All"===v?"All":Number(v);setRowsPerPage(next)},className:"h-9 rounded-md border border-white/10 bg-white/5 px-2 text-sm text-white",children:[(0,jsx_runtime.jsx)("option",{value:10,children:"10"}),(0,jsx_runtime.jsx)("option",{value:25,children:"25"}),(0,jsx_runtime.jsx)("option",{value:50,children:"50"}),(0,jsx_runtime.jsx)("option",{value:100,children:"100"}),(0,jsx_runtime.jsx)("option",{value:"All",children:"All"})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-1",children:[(0,jsx_runtime.jsx)(ui_button.$,{type:"button",variant:"outline",size:"sm",onClick:()=>setPage(1),disabled:paged.page<=1,children:"First"}),(0,jsx_runtime.jsx)(ui_button.$,{type:"button",variant:"outline",size:"sm",onClick:()=>setPage(p=>Math.max(1,p-1)),disabled:paged.page<=1,children:"Prev"}),(0,jsx_runtime.jsxs)("div",{className:"px-2 text-xs font-semibold text-gray-300",children:[paged.page,"/",paged.pageCount]}),(0,jsx_runtime.jsx)(ui_button.$,{type:"button",variant:"outline",size:"sm",onClick:()=>setPage(p=>Math.min(paged.pageCount,p+1)),disabled:paged.page>=paged.pageCount,children:"Next"}),(0,jsx_runtime.jsx)(ui_button.$,{type:"button",variant:"outline",size:"sm",onClick:()=>setPage(paged.pageCount),disabled:paged.page>=paged.pageCount,children:"Last"})]})]})]}),loading?(0,jsx_runtime.jsx)("div",{className:"flex items-center justify-center py-16",children:(0,jsx_runtime.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}):error?(0,jsx_runtime.jsx)("div",{className:"p-6 text-sm font-semibold text-red-300",children:error}):0===sorted.length?(0,jsx_runtime.jsxs)("div",{className:"p-10 text-center",children:[(0,jsx_runtime.jsx)("div",{className:"text-sm font-semibold text-white",children:"No campaigns match your filters"}),(0,jsx_runtime.jsx)("div",{className:"mt-1 text-sm text-gray-400",children:"Try adjusting status or success rate."})]}):(0,jsx_runtime.jsx)("div",{className:"overflow-hidden",children:(0,jsx_runtime.jsxs)("div",{className:"min-w-[980px]",children:[TableHeader,(0,jsx_runtime.jsxs)("div",{ref:tableScrollRef,className:(0,utils.cn)("relative max-h-[520px] overflow-y-auto overscroll-contain",useVirtual?"pb-2":""),role:"rowgroup",children:[useVirtual&&virtual?(0,jsx_runtime.jsx)("div",{style:{height:virtual.topPad}}):null,visibleRows.map(campaign=>{const st=(0,campaign_performance.mo)(campaign.status),progress=(0,campaign_performance.Jb)(campaign),success=(0,campaign_performance.p$)(campaign),isSelected=selected.has(campaign.id),isExpanded=expanded.has(campaign.id),canPause="Active"===st,canResume="Paused"===st||"Draft"===st||"Failed"===st;return(0,jsx_runtime.jsxs)("div",{className:"border-b border-white/5",children:[(0,jsx_runtime.jsxs)("div",{role:"row",className:"grid grid-cols-[40px_1.4fr_120px_160px_140px_110px_110px_110px_170px_44px] items-center gap-2 px-3 py-2 text-sm text-white",children:[(0,jsx_runtime.jsx)("div",{className:"flex items-center justify-center",children:(0,jsx_runtime.jsx)("input",{"aria-label":`Select ${campaign.name}`,type:"checkbox",checked:isSelected,onChange:e=>{return id=campaign.id,next=e.target.checked,void setSelected(prev=>{const copy=new Set(prev);return next?copy.add(id):copy.delete(id),copy});var id,next},className:"h-4 w-4 rounded border-white/20 bg-white/5"})}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center gap-2 px-2",children:[(0,jsx_runtime.jsx)("button",{type:"button","aria-label":isExpanded?"Collapse row details":"Expand row details",className:"rounded-md p-1 text-gray-300 hover:bg-white/5 hover:text-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white/30",onClick:()=>{return id=campaign.id,void setExpanded(prev=>{const copy=new Set(prev);return copy.has(id)?copy.delete(id):copy.add(id),copy});var id},children:isExpanded?(0,jsx_runtime.jsx)(chevron_down.A,{className:"h-4 w-4"}):(0,jsx_runtime.jsx)(ChevronRight,{className:"h-4 w-4"})}),(0,jsx_runtime.jsxs)("button",{type:"button",className:"min-w-0 flex-1 text-left",onClick:()=>setDetailsId(campaign.id),children:[(0,jsx_runtime.jsx)("div",{className:"truncate font-semibold hover:underline",children:campaign.name}),(0,jsx_runtime.jsx)("div",{className:"truncate text-xs text-gray-400",children:campaign.description||"—"})]})]}),(0,jsx_runtime.jsx)("div",{className:"px-2",children:(0,jsx_runtime.jsx)("span",{className:(0,utils.cn)("inline-flex items-center rounded-full px-2 py-0.5 text-xs font-semibold",(0,campaign_performance.AO)(st)),children:st})}),(0,jsx_runtime.jsx)("div",{className:"px-2",children:(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,jsx_runtime.jsx)("div",{className:"h-2 w-20 overflow-hidden rounded-full bg-white/10",children:(0,jsx_runtime.jsx)("div",{className:(0,utils.cn)("h-full",(0,campaign_performance.Nl)(progress)),style:{width:`${progress.toFixed(1)}%`}})}),(0,jsx_runtime.jsx)("div",{className:"w-12 text-right text-xs font-semibold tabular-nums text-gray-200",children:(0,campaign_performance.R8)(progress)})]})}),(0,jsx_runtime.jsx)("div",{className:"px-2 text-right text-sm font-semibold tabular-nums text-gray-200",children:(0,campaign_performance.R8)(success)}),(0,jsx_runtime.jsx)("div",{className:"px-2 text-right tabular-nums text-gray-200",children:Number(campaign.total_leads||0).toLocaleString()}),(0,jsx_runtime.jsx)("div",{className:"px-2 text-right tabular-nums text-gray-200",children:Number(campaign.calls_completed||0).toLocaleString()}),(0,jsx_runtime.jsx)("div",{className:"px-2 text-right tabular-nums text-gray-200",children:Number(campaign.calls_failed||0).toLocaleString()}),(0,jsx_runtime.jsx)("div",{className:"px-2 text-right text-xs font-semibold tabular-nums text-gray-300",children:new Date(campaign.created_at).toLocaleDateString()}),(0,jsx_runtime.jsxs)("div",{className:"relative flex items-center justify-end",children:[(0,jsx_runtime.jsx)("button",{type:"button","aria-label":"Row actions",className:"rounded-md p-2 text-gray-300 hover:bg-white/5 hover:text-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white/30",onClick:()=>setMenuOpenFor(v=>v===campaign.id?null:campaign.id),children:(0,jsx_runtime.jsx)(Ellipsis,{className:"h-4 w-4"})}),menuOpenFor===campaign.id?(0,jsx_runtime.jsxs)("div",{ref:node=>{menuRefs.current[campaign.id]=node},role:"menu",className:"absolute right-0 top-10 z-20 w-56 overflow-hidden rounded-xl border border-white/10 bg-gray-950/95 shadow-xl",children:[(0,jsx_runtime.jsx)("button",{type:"button",role:"menuitem",className:"flex w-full items-center gap-2 px-3 py-2 text-left text-sm text-white hover:bg-white/5",onClick:()=>{setMenuOpenFor(null),setDetailsId(campaign.id)},children:"View Details"}),(0,jsx_runtime.jsx)("button",{type:"button",role:"menuitem",className:(0,utils.cn)("flex w-full items-center gap-2 px-3 py-2 text-left text-sm text-white hover:bg-white/5",canPause||canResume?"":"opacity-50"),disabled:!(canPause||canResume),onClick:async()=>{setMenuOpenFor(null),canPause?await onPause(campaign.id):canResume&&await onResume(campaign.id)},children:canPause?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Pause,{className:"h-4 w-4"})," Pause Campaign"]}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Play,{className:"h-4 w-4"})," Resume Campaign"]})}),(0,jsx_runtime.jsx)("button",{type:"button",role:"menuitem",className:"flex w-full items-center gap-2 px-3 py-2 text-left text-sm text-white hover:bg-white/5",onClick:()=>{setMenuOpenFor(null),setEditId(campaign.id)},children:"Edit Settings"}),(0,jsx_runtime.jsx)("button",{type:"button",role:"menuitem",className:"flex w-full items-center gap-2 px-3 py-2 text-left text-sm text-white hover:bg-white/5",onClick:()=>{setMenuOpenFor(null),router.push(`/analytics?campaign=${encodeURIComponent(campaign.id)}`)},children:"View Analytics"}),(0,jsx_runtime.jsxs)("button",{type:"button",role:"menuitem",className:"flex w-full items-center gap-2 px-3 py-2 text-left text-sm text-white hover:bg-white/5",onClick:async()=>{setMenuOpenFor(null),await onDuplicate(campaign.id)},children:[(0,jsx_runtime.jsx)(Copy,{className:"h-4 w-4"}),"Duplicate"]}),(0,jsx_runtime.jsxs)("button",{type:"button",role:"menuitem",className:"flex w-full items-center gap-2 px-3 py-2 text-left text-sm text-red-200 hover:bg-red-500/10",onClick:()=>{setMenuOpenFor(null),setConfirmDeleteId(campaign.id)},children:[(0,jsx_runtime.jsx)(Trash2,{className:"h-4 w-4"}),"Delete"]})]}):null]})]}),isExpanded?(0,jsx_runtime.jsxs)("div",{className:"grid grid-cols-1 gap-4 px-6 pb-5 pt-3 text-sm text-gray-200 md:grid-cols-3",children:[(0,jsx_runtime.jsxs)("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,jsx_runtime.jsx)("div",{className:"text-xs font-semibold text-gray-300",children:"Performance breakdown"}),(0,jsx_runtime.jsxs)("div",{className:"mt-3 space-y-2",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jsx_runtime.jsx)("div",{className:"text-sm text-gray-200",children:"Completion"}),(0,jsx_runtime.jsx)("div",{className:"text-sm font-semibold tabular-nums text-white",children:(0,campaign_performance.R8)(progress)})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jsx_runtime.jsx)("div",{className:"text-sm text-gray-200",children:"Success rate"}),(0,jsx_runtime.jsx)("div",{className:"text-sm font-semibold tabular-nums text-white",children:(0,campaign_performance.R8)(success)})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jsx_runtime.jsx)("div",{className:"text-sm text-gray-200",children:"Leads"}),(0,jsx_runtime.jsx)("div",{className:"text-sm font-semibold tabular-nums text-white",children:Number(campaign.total_leads||0).toLocaleString()})]})]})]}),(0,jsx_runtime.jsxs)("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,jsx_runtime.jsx)("div",{className:"text-xs font-semibold text-gray-300",children:"Recent activity"}),(0,jsx_runtime.jsxs)("div",{className:"mt-3 space-y-2",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jsx_runtime.jsx)("div",{className:"text-sm text-gray-200",children:"Last update"}),(0,jsx_runtime.jsx)("div",{className:"text-xs font-semibold text-gray-300",children:new Date(campaign.created_at).toLocaleString()})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jsx_runtime.jsx)("div",{className:"text-sm text-gray-200",children:"Status change"}),(0,jsx_runtime.jsx)("div",{className:"text-xs font-semibold text-gray-300",children:st})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jsx_runtime.jsx)("div",{className:"text-sm text-gray-200",children:"Agent"}),(0,jsx_runtime.jsx)("div",{className:"text-xs font-semibold text-gray-300",children:"Talky AI"})]})]})]}),(0,jsx_runtime.jsxs)("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,jsx_runtime.jsx)("div",{className:"text-xs font-semibold text-gray-300",children:"Assets & resources"}),(0,jsx_runtime.jsxs)("div",{className:"mt-3 space-y-2 text-sm text-gray-200",children:[(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jsx_runtime.jsx)("div",{children:"Script"}),(0,jsx_runtime.jsx)("div",{className:"text-xs font-semibold text-gray-300 truncate max-w-[160px]",children:campaign.voice_id})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jsx_runtime.jsx)("div",{children:"Prompt"}),(0,jsx_runtime.jsx)("div",{className:"text-xs font-semibold text-gray-300 truncate max-w-[160px]",children:campaign.system_prompt?.slice(0,16)||"—"})]}),(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jsx_runtime.jsx)("div",{children:"Concurrency"}),(0,jsx_runtime.jsx)("div",{className:"text-xs font-semibold text-gray-300 tabular-nums",children:campaign.max_concurrent_calls||0})]})]})]})]}):null]},campaign.id)}),useVirtual&&virtual?(0,jsx_runtime.jsx)("div",{style:{height:virtual.bottomPad}}):null]})]})})]}),(0,jsx_runtime.jsxs)(modal.a,{open:exportOpen,onOpenChange:setExportOpen,title:"Export & Reporting",description:selected.size>0?"Exports selected campaigns.":"Exports the current page.",size:"lg",children:[(0,jsx_runtime.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,jsx_runtime.jsxs)("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,jsx_runtime.jsx)("div",{className:"text-sm font-semibold text-white",children:"Export format"}),(0,jsx_runtime.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2",children:[(0,jsx_runtime.jsx)(ui_button.$,{type:"button",variant:"secondary",onClick:()=>onExport("pdf"),children:"PDF"}),(0,jsx_runtime.jsx)(ui_button.$,{type:"button",variant:"secondary",onClick:()=>onExport("csv"),children:"Excel"}),(0,jsx_runtime.jsx)(ui_button.$,{type:"button",variant:"secondary",onClick:()=>onExport("csv"),children:"CSV"}),(0,jsx_runtime.jsx)(ui_button.$,{type:"button",variant:"secondary",onClick:()=>onExport("json"),children:"JSON"})]}),(0,jsx_runtime.jsx)("div",{className:"mt-3 text-xs font-semibold text-gray-300",children:"PDF opens a print view; save as PDF from your browser."})]}),(0,jsx_runtime.jsxs)("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,jsx_runtime.jsx)("div",{className:"text-sm font-semibold text-white",children:"Scheduling"}),(0,jsx_runtime.jsx)("div",{className:"mt-2 text-sm text-gray-300",children:"Save recurring settings locally (prototype mode)."}),(0,jsx_runtime.jsx)(ReportScheduleEditor,{storageKey:"campaigns.performance.reportSchedule"})]})]}),(0,jsx_runtime.jsxs)("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,jsx_runtime.jsxs)("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,jsx_runtime.jsx)("div",{className:"text-sm font-semibold text-white",children:"Date range"}),(0,jsx_runtime.jsxs)("div",{className:"mt-3 grid grid-cols-1 gap-3",children:[(0,jsx_runtime.jsxs)("select",{"aria-label":"Export date range preset",value:exportPreset,onChange:e=>setExportPreset(e.target.value),className:"h-10 rounded-md border border-white/10 bg-white/5 px-2 text-sm text-white",children:[(0,jsx_runtime.jsx)("option",{value:"All Time",children:"All Time"}),(0,jsx_runtime.jsx)("option",{value:"Last 7 Days",children:"Last 7 Days"}),(0,jsx_runtime.jsx)("option",{value:"Last 30 Days",children:"Last 30 Days"}),(0,jsx_runtime.jsx)("option",{value:"This Month",children:"This Month"}),(0,jsx_runtime.jsx)("option",{value:"Custom",children:"Custom"})]}),"Custom"===exportPreset?(0,jsx_runtime.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"text-xs font-semibold text-gray-300",children:"From"}),(0,jsx_runtime.jsx)("input",{type:"date",value:exportFrom,onChange:e=>setExportFrom(e.target.value),className:"mt-1 h-10 w-full rounded-md border border-white/10 bg-white/5 px-2 text-sm text-white"})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"text-xs font-semibold text-gray-300",children:"To"}),(0,jsx_runtime.jsx)("input",{type:"date",value:exportTo,onChange:e=>setExportTo(e.target.value),className:"mt-1 h-10 w-full rounded-md border border-white/10 bg-white/5 px-2 text-sm text-white"})]})]}):null,(0,jsx_runtime.jsxs)("div",{className:"text-xs font-semibold text-gray-300",children:["Using campaign created date • ",exportRange.label]})]})]}),(0,jsx_runtime.jsxs)("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,jsx_runtime.jsx)("div",{className:"text-sm font-semibold text-white",children:"Columns"}),(0,jsx_runtime.jsx)("div",{className:"mt-3 grid grid-cols-1 gap-2 md:grid-cols-2",children:EXPORT_COLUMNS.map(c=>{const checked=exportCols.has(c.key);return(0,jsx_runtime.jsxs)("label",{className:"flex items-center justify-between gap-3 rounded-lg border border-white/10 bg-white/5 px-3 py-2",children:[(0,jsx_runtime.jsx)("div",{className:"text-sm font-semibold text-white",children:c.label}),(0,jsx_runtime.jsx)("input",{type:"checkbox",checked,onChange:e=>{const next=e.target.checked;setExportCols(prev=>{const set=new Set(prev);return next?set.add(c.key):set.delete(c.key),set})},className:"h-4 w-4 rounded border-white/20 bg-white/5"})]},c.key)})})]})]}),(0,jsx_runtime.jsxs)("div",{className:"mt-4 rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,jsx_runtime.jsx)("div",{className:"text-sm font-semibold text-white",children:"Included rows"}),(0,jsx_runtime.jsxs)("div",{className:"mt-2 text-sm text-gray-300",children:[exportItems.length," campaigns"]})]})]}),(0,jsx_runtime.jsx)(modal.a,{open:null!==detailsId,onOpenChange:next=>setDetailsId(next?detailsId:null),title:detailsCampaign?detailsCampaign.name:"Campaign Details",description:detailsCampaign?(0,campaign_performance.mo)(detailsCampaign.status):void 0,size:"lg",children:detailsCampaign?(0,jsx_runtime.jsxs)("div",{className:"space-y-4",children:[(0,jsx_runtime.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[(0,jsx_runtime.jsxs)("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,jsx_runtime.jsx)("div",{className:"text-xs font-semibold text-gray-300",children:"Completion"}),(0,jsx_runtime.jsx)("div",{className:"mt-2 text-2xl font-black tabular-nums text-white",children:(0,campaign_performance.R8)((0,campaign_performance.Jb)(detailsCampaign))})]}),(0,jsx_runtime.jsxs)("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,jsx_runtime.jsx)("div",{className:"text-xs font-semibold text-gray-300",children:"Success Rate"}),(0,jsx_runtime.jsx)("div",{className:"mt-2 text-2xl font-black tabular-nums text-white",children:(0,campaign_performance.R8)((0,campaign_performance.p$)(detailsCampaign))})]}),(0,jsx_runtime.jsxs)("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,jsx_runtime.jsx)("div",{className:"text-xs font-semibold text-gray-300",children:"Leads"}),(0,jsx_runtime.jsx)("div",{className:"mt-2 text-2xl font-black tabular-nums text-white",children:Number(detailsCampaign.total_leads||0).toLocaleString()})]})]}),(0,jsx_runtime.jsxs)("div",{className:"rounded-xl border border-white/10 bg-white/5 p-4",children:[(0,jsx_runtime.jsx)("div",{className:"text-sm font-semibold text-white",children:"Description"}),(0,jsx_runtime.jsx)("div",{className:"mt-2 text-sm text-gray-200",children:detailsCampaign.description||"—"})]}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,jsx_runtime.jsx)(Link,{href:`/campaigns/${detailsCampaign.id}`,children:(0,jsx_runtime.jsx)(ui_button.$,{type:"button",variant:"secondary",children:"Open Page"})}),(0,jsx_runtime.jsx)(ui_button.$,{type:"button",variant:"outline",onClick:()=>{setDetailsId(null),setEditId(detailsCampaign.id)},children:"Edit Settings"}),(0,jsx_runtime.jsx)(ui_button.$,{type:"button",variant:"outline",onClick:()=>router.push(`/analytics?campaign=${encodeURIComponent(detailsCampaign.id)}`),children:"View Analytics"})]})]}):null}),(0,jsx_runtime.jsx)(modal.a,{open:null!==editId,onOpenChange:next=>setEditId(next?editId:null),title:editCampaign?`Edit: ${editCampaign.name}`:"Edit Campaign",size:"lg",footer:(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,jsx_runtime.jsx)(ui_button.$,{type:"button",variant:"outline",onClick:()=>setEditId(null),children:"Cancel"}),(0,jsx_runtime.jsx)(ui_button.$,{type:"button",onClick:async()=>{editCampaign&&editDraft&&(await onUpdate({...editCampaign,name:editDraft.name,description:editDraft.description,max_concurrent_calls:Math.max(0,Math.floor(editDraft.maxConcurrent||0)),voice_id:editDraft.voiceId}),setEditId(null))},children:"Save"})]}),children:editCampaign&&editDraft?(0,jsx_runtime.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"text-xs font-semibold text-gray-300",children:"Name"}),(0,jsx_runtime.jsx)(input.p,{value:editDraft.name,onChange:e=>setEditDraft(p=>p?{...p,name:e.target.value}:p),className:"mt-1 border-white/10 bg-white/5 text-white placeholder:text-gray-400 focus-visible:ring-white/30"})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"text-xs font-semibold text-gray-300",children:"Voice ID"}),(0,jsx_runtime.jsx)(input.p,{value:editDraft.voiceId,onChange:e=>setEditDraft(p=>p?{...p,voiceId:e.target.value}:p),className:"mt-1 border-white/10 bg-white/5 text-white placeholder:text-gray-400 focus-visible:ring-white/30"})]}),(0,jsx_runtime.jsxs)("div",{className:"md:col-span-2",children:[(0,jsx_runtime.jsx)("label",{className:"text-xs font-semibold text-gray-300",children:"Description"}),(0,jsx_runtime.jsx)("textarea",{value:editDraft.description,onChange:e=>setEditDraft(p=>p?{...p,description:e.target.value}:p),className:"mt-1 h-24 w-full resize-none rounded-md border border-white/10 bg-white/5 px-3 py-2 text-sm text-white placeholder:text-gray-400 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white/30"})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"text-xs font-semibold text-gray-300",children:"Max concurrent calls"}),(0,jsx_runtime.jsx)(input.p,{type:"number",min:0,value:editDraft.maxConcurrent,onChange:e=>setEditDraft(p=>p?{...p,maxConcurrent:Number(e.target.value)}:p),className:"mt-1 border-white/10 bg-white/5 text-white placeholder:text-gray-400 focus-visible:ring-white/30"})]})]}):null}),(0,jsx_runtime.jsx)(modal.a,{open:null!==confirmDeleteId,onOpenChange:next=>setConfirmDeleteId(next?confirmDeleteId:null),title:"Confirm delete",description:"__bulk__"===confirmDeleteId?"Delete all selected campaigns?":"Delete this campaign?",size:"sm",footer:(0,jsx_runtime.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,jsx_runtime.jsx)(ui_button.$,{type:"button",variant:"outline",onClick:()=>setConfirmDeleteId(null),children:"Cancel"}),(0,jsx_runtime.jsx)(ui_button.$,{type:"button",variant:"destructive",onClick:async()=>{confirmDeleteId&&("__bulk__"===confirmDeleteId?await(async()=>{const ids=Array.from(selected);for(const id of ids)await onDelete(id);setSelected(new Set)})():await onDelete(confirmDeleteId),setConfirmDeleteId(null))},children:"Delete"})]}),children:(0,jsx_runtime.jsx)("div",{className:"text-sm text-gray-200",children:"This action cannot be undone."})})]})}function ReportScheduleEditor({storageKey}){const[enabled,setEnabled]=(0,react.useState)(!1),[recurrence,setRecurrence]=(0,react.useState)("Weekly"),[delivery,setDelivery]=(0,react.useState)("Email"),[time,setTime]=(0,react.useState)("09:00"),[recipients,setRecipients]=(0,react.useState)("ops@company.com"),[webhook,setWebhook]=(0,react.useState)("https://example.com/webhook");return(0,react.useEffect)(()=>{try{const raw=window.localStorage.getItem(storageKey);if(!raw)return;const parsed=JSON.parse(raw);if(!parsed||"object"!=typeof parsed)return;const p=parsed,nextEnabled=Boolean(p.enabled),nextRecurrence="Daily"===p.recurrence||"Weekly"===p.recurrence||"Monthly"===p.recurrence?p.recurrence:null,nextDelivery="Email"===p.delivery||"Webhook"===p.delivery?p.delivery:null,nextTime="string"==typeof p.time?p.time:null,nextRecipients="string"==typeof p.recipients?p.recipients:null,nextWebhook="string"==typeof p.webhook?p.webhook:null,raf=window.requestAnimationFrame(()=>{setEnabled(nextEnabled),nextRecurrence&&setRecurrence(nextRecurrence),nextDelivery&&setDelivery(nextDelivery),nextTime&&setTime(nextTime),nextRecipients&&setRecipients(nextRecipients),nextWebhook&&setWebhook(nextWebhook)});return()=>window.cancelAnimationFrame(raf)}catch{}},[storageKey]),(0,react.useEffect)(()=>{try{window.localStorage.setItem(storageKey,JSON.stringify({enabled,recurrence,delivery,time,recipients,webhook}))}catch{}},[delivery,enabled,recurrence,recipients,storageKey,time,webhook]),(0,jsx_runtime.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,jsx_runtime.jsxs)("label",{className:"flex items-center justify-between gap-3 rounded-lg border border-white/10 bg-white/5 px-3 py-2",children:[(0,jsx_runtime.jsx)("div",{className:"text-sm font-semibold text-white",children:"Enable recurring report"}),(0,jsx_runtime.jsx)("input",{type:"checkbox",checked:enabled,onChange:e=>setEnabled(e.target.checked),className:"h-4 w-4 rounded border-white/20 bg-white/5"})]}),(0,jsx_runtime.jsxs)("div",{className:(0,utils.cn)("grid grid-cols-1 gap-3 md:grid-cols-2",enabled?"":"opacity-50"),"aria-disabled":!enabled,children:[(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"text-xs font-semibold text-gray-300",children:"Recurrence"}),(0,jsx_runtime.jsxs)("select",{value:recurrence,disabled:!enabled,onChange:e=>{const v=e.target.value;"Daily"!==v&&"Weekly"!==v&&"Monthly"!==v||setRecurrence(v)},className:"mt-1 h-10 w-full rounded-md border border-white/10 bg-white/5 px-2 text-sm text-white",children:[(0,jsx_runtime.jsx)("option",{value:"Daily",children:"Daily"}),(0,jsx_runtime.jsx)("option",{value:"Weekly",children:"Weekly"}),(0,jsx_runtime.jsx)("option",{value:"Monthly",children:"Monthly"})]})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"text-xs font-semibold text-gray-300",children:"Delivery"}),(0,jsx_runtime.jsxs)("select",{value:delivery,disabled:!enabled,onChange:e=>{const v=e.target.value;"Email"!==v&&"Webhook"!==v||setDelivery(v)},className:"mt-1 h-10 w-full rounded-md border border-white/10 bg-white/5 px-2 text-sm text-white",children:[(0,jsx_runtime.jsx)("option",{value:"Email",children:"Email"}),(0,jsx_runtime.jsx)("option",{value:"Webhook",children:"Webhook"})]})]}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("label",{className:"text-xs font-semibold text-gray-300",children:"Time"}),(0,jsx_runtime.jsx)("input",{type:"time",value:time,disabled:!enabled,onChange:e=>setTime(e.target.value),className:"mt-1 h-10 w-full rounded-md border border-white/10 bg-white/5 px-2 text-sm text-white"})]}),"Email"===delivery?(0,jsx_runtime.jsxs)("div",{className:"md:col-span-2",children:[(0,jsx_runtime.jsx)("label",{className:"text-xs font-semibold text-gray-300",children:"Recipients"}),(0,jsx_runtime.jsx)(input.p,{value:recipients,disabled:!enabled,onChange:e=>setRecipients(e.target.value),className:"mt-1 border-white/10 bg-white/5 text-white placeholder:text-gray-400 focus-visible:ring-white/30"})]}):(0,jsx_runtime.jsxs)("div",{className:"md:col-span-2",children:[(0,jsx_runtime.jsx)("label",{className:"text-xs font-semibold text-gray-300",children:"Webhook URL"}),(0,jsx_runtime.jsx)(input.p,{value:webhook,disabled:!enabled,onChange:e=>setWebhook(e.target.value),className:"mt-1 border-white/10 bg-white/5 text-white placeholder:text-gray-400 focus-visible:ring-white/30"})]})]})]})}CampaignPerformanceTable.__docgenInfo={description:"",methods:[],displayName:"CampaignPerformanceTable",props:{campaigns:{required:!0,tsType:{name:"Array",elements:[{name:"Campaign"}],raw:"Campaign[]"},description:""},loading:{required:!0,tsType:{name:"boolean"},description:""},error:{required:!0,tsType:{name:"string"},description:""},onPause:{required:!0,tsType:{name:"signature",type:"function",raw:"(id: string) => Promise<void>",signature:{arguments:[{type:{name:"string"},name:"id"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onResume:{required:!0,tsType:{name:"signature",type:"function",raw:"(id: string) => Promise<void>",signature:{arguments:[{type:{name:"string"},name:"id"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onDelete:{required:!0,tsType:{name:"signature",type:"function",raw:"(id: string) => Promise<void>",signature:{arguments:[{type:{name:"string"},name:"id"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onDuplicate:{required:!0,tsType:{name:"signature",type:"function",raw:"(id: string) => Promise<void>",signature:{arguments:[{type:{name:"string"},name:"id"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onUpdate:{required:!0,tsType:{name:"signature",type:"function",raw:"(next: Campaign) => Promise<void>",signature:{arguments:[{type:{name:"Campaign"},name:"next"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""}}};const campaign_performance_table_stories={title:"Campaigns/CampaignPerformanceTable",component:CampaignPerformanceTable,args:{campaigns:[{id:"camp-001",name:"Holiday Sales Outreach",description:"End of year promotional campaign for existing customers",status:"running",system_prompt:"You are a friendly sales representative...",voice_id:"voice-001",max_concurrent_calls:10,total_leads:500,calls_completed:342,calls_failed:45,created_at:"2025-12-15T10:00:00Z",started_at:"2025-12-16T09:00:00Z"},{id:"camp-002",name:"Customer Satisfaction Survey",description:"Post-purchase feedback collection",status:"paused",system_prompt:"You are conducting a brief customer satisfaction survey...",voice_id:"voice-002",max_concurrent_calls:5,total_leads:200,calls_completed:87,calls_failed:12,created_at:"2025-12-20T14:00:00Z",started_at:"2025-12-21T10:00:00Z"},{id:"camp-003",name:"New Product Launch",description:"Introducing our latest product line to premium customers",status:"draft",system_prompt:"You are introducing an exciting new product...",voice_id:"voice-003",max_concurrent_calls:15,total_leads:750,calls_completed:0,calls_failed:0,created_at:"2025-12-28T16:00:00Z"},{id:"camp-004",name:"Appointment Reminders",description:"Automated appointment reminder calls",status:"completed",system_prompt:"You are calling to remind about an upcoming appointment...",voice_id:"voice-001",max_concurrent_calls:20,total_leads:300,calls_completed:285,calls_failed:15,created_at:"2025-12-10T08:00:00Z",started_at:"2025-12-11T07:00:00Z",completed_at:"2025-12-12T18:00:00Z"}],loading:!1,error:"",onPause:async()=>{},onResume:async()=>{},onDelete:async()=>{},onDuplicate:async()=>{},onUpdate:async()=>{}}},Default={},__namedExportsOrder=["Default"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"{}",...Default.parameters?.docs?.source}}}},"./src/components/ui/input.tsx"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{p:()=>Input});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_lib_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/lib/utils.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");const Input=react__WEBPACK_IMPORTED_MODULE_0__.forwardRef(({className,type,...props},ref)=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("input",{type,className:(0,_lib_utils__WEBPACK_IMPORTED_MODULE_1__.cn)("flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-gray-900 placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-400 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",className),ref,...props}));Input.displayName="Input",Input.__docgenInfo={description:"",methods:[],displayName:"Input"}}}]);